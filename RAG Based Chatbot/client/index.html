<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Chatbot</title>
    <link rel="icon" href="https://fav.farm/ðŸ¤–" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>

    <!-- Firebase SDK Implementation -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC8x57saUtHCrDY8Xwr_yyZLwtCmjMQhwM",
            authDomain: "rag-based-chatbot-eacf7.firebaseapp.com",
            projectId: "rag-based-chatbot-eacf7",
            storageBucket: "rag-based-chatbot-eacf7.firebasestorage.app",
            messagingSenderId: "198488273514",
            appId: "1:198488273514:web:62ef9332d9682487d75013",
            measurementId: "G-LSF9LNW8M3"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        console.log("Firebase initialized successfully");
    </script>
</head>

<body>
    <div class="bg-glow"></div>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>History</h2>
            </div>
            <div class="history-list" id="history-list">
                <div class="history-item active">Current Session</div>
            </div>
            <div class="sidebar-footer">
                <button id="new-chat-btn" class="btn secondary">New Chat</button>
            </div>
        </aside>

        <main class="chat-container">
            <header class="chat-header">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <button id="menu-btn" class="icon-btn menu-btn" style="display: none;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <h1>RAG Assistant</h1>
                </div>
                <div class="status-indicator" id="status-indicator">
                    <span class="dot"></span> <span id="status-text">Connecting...</span>
                </div>
            </header>

            <div class="messages-area" id="messages-area">
                <div class="message assistant">
                    <div class="avatar">ðŸ¤–</div>
                    <div class="message-content">
                        <div class="bubble">
                            Greetings! âœ¨ I'm your Personal Knowledge Assistant. <br><br>
                            I've analyzed your documents and I'm ready to help you find answers, summarize content, or
                            brainstorm ideas based on your data. What's on your mind today?
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-area">
                <div class="input-wrapper">
                    <input type="file" id="file-input" style="display: none;" accept=".pdf,.txt">
                    <button id="upload-btn" class="icon-btn" title="Upload PDF/TXT">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                            </path>
                        </svg>
                    </button>
                    <textarea id="user-input" placeholder="Type your message..." rows="1"></textarea>
                    <button id="send-btn" class="icon-btn send-btn" title="Send">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                </div>
                <div class="input-footer">
                    <span id="char-count">0 / 2000</span>
                </div>
                <div id="upload-status-container" class="upload-status-container"></div>
                <!-- Hidden API Config for cleaner look (can be toggled if needed) -->
                <div class="api-config" style="display: none;">
                    <input type="text" id="api-url" value="">
                    <button id="save-url-btn">Set</button>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>

</html>